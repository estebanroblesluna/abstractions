<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Lifia</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link rel="shortcut icon" href="../../imagenes/lifiaicon.ico" >
<style type="text/css">
<!--
@import url("../estilos_lifia.css");
body {
	background-color: #bec2d1;
	margin-left: 0px;
	margin-top: 5px;
	margin-right: 0px;
	margin-bottom: 0px;
	background-image: url();
}
a:link {
	color: #255282;
	text-decoration: none;
}
a:visited {
	text-decoration: none;
	color: #255282;
}
a:hover {
	text-decoration: none;
	color: #FF9933;
}
a:active {
	text-decoration: none;
	color: #FF9933;
}
.Estilo4 {color: #666666}
.Estilo8 {color: #1EA173}
.Estilo9 {color: #333399}

.centro{FONT-SIZE: 13px; COLOR: #666666; font-weight:bold;FONT-FAMILY: "Trebuchet MS", Verdana;
text-align:center;}
.linkTexto {
		COLOR: #0033CC; 	text-decoration:underline;
		font-weight:bold;}
-->
</style>
</head>

<body>
<script type="text/javascript" src="wz_tooltip.js"></script>
<table width="830" border="0" align="center" cellpadding="0" cellspacing="0" background="../imagenes/line_830.gif">
  <!--DWLayoutTable-->
  <tr>
    <td width="30" rowspan="8" valign="top"><img src="../imagenes/spacer_izq2.gif" width="30" height="615"></td>
    <td colspan="4" valign="top"><table width="780" height="114" border="0" cellpadding="0" cellspacing="0">
        <!--DWLayoutTable-->
        <tr>
          <td width="780" height="170" valign="top"><img src="../imagenes/top_difusion.gif" width="780" height="172" border="0" usemap="#Map"></td>
        </tr>
    </table></td>
  <td width="20" rowspan="8" valign="top"><img src="../imagenes/spacer_der2.gif" width="20" height="485"></td>
  </tr>
  <tr>
    <td width="247" rowspan="5" valign="top"><table width="247" border="0" cellpadding="0" cellspacing="0">
        <!--DWLayoutTable-->
        <tr>
          <td height="19" colspan="3" valign="top"><img src="../imagenes/spacer_vert_19.gif" width="10" height="19"></td>
        </tr>
        <tr>
          <td width="41" rowspan="7" valign="top"><!--DWLayoutEmptyCell-->&nbsp;</td>
          <td height="19" colspan="2" valign="top" nowrap class="menu_izq"><a href="../index.htm" target="_self">Bienvenida</a></td>
        </tr>
        <tr>
          <td height="19" colspan="2" valign="top" nowrap class="menu_izq"><a href="../about_us.htm" target="_self">Sobre nosotros</a> </td>
        </tr>
        <tr>
          <td height="19" colspan="2" valign="top" nowrap class="menu_izq"><a href="../research.htm">Investigaci&oacute;n</a> </td>
        </tr>
        <tr>
          <td height="19" colspan="2" valign="top" nowrap><span class="menu_izq"> <a href="../publications.htm" target="_self">Publicaciones </a></span> &#13;</td>
        </tr>
        <tr>
          <td height="19" colspan="2" valign="top" nowrap class="menu_izq"><a href="../technology.htm" target="_self">Transferencia de tec. &amp; servicios </a>&#13;</td>
        </tr>
        <tr>
          <td height="19" colspan="2" valign="top" class="menu_izq"><span class="menu_izq Estilo8"> <a href="../capabilities.htm">Capacidades &#13;</a><strong> <a href="capabilities.htm">&#13;&#13;</a></strong></span> &#13;</td>
        </tr>
        <tr>
          <td height="19" colspan="2" valign="top"><a href="../difusion.htm" class="menu_izq"><strong>Difusi&oacute;n</strong></a></td>
        </tr>
        <tr>
          <td height="57">&nbsp;</td>
          <td width="84">&nbsp;</td>
          <td width="122">&nbsp;</td>
        </tr>
        <tr>
          <td height="84" colspan="3" valign="top"><img src="../imagenes/spacer_vert_84.gif" width="10" height="84"></td>
        </tr>
        <tr>
          <td height="16" colspan="2" valign="top"><div align="center" class="menu_negrita Estilo4"><a href="../sitemap.htm" target="_self">mapa del sitio</a> </div></td>
              <td rowspan="5" valign="top"><!--DWLayoutEmptyCell-->&nbsp;</td>
        </tr>
        <tr>
          <td height="16" colspan="2" valign="top"><div align="center" class="menu_negrita"><a href="../staff.htm" target="_self">staff</a></div></td>
        </tr>
        <tr>
          <td height="16" colspan="2" valign="top"><div align="center" class="menu_negrita Estilo4"><a href="../contact.htm" target="_self">contacto</a></div></td>
        </tr>
        <tr>
          <td height="16" colspan="2" valign="top"><div align="center" class="menu_negrita Estilo4"><a href="../../en/index.htm" target="_self">english version</a> </div></td>
        </tr>
        <tr>
          <td height="16"></td>
          <td></td>
        </tr>
		        <tr>
		          <td>&nbsp;</td>
                  <td>&nbsp;</td>
                  <td>&nbsp;</td>
        </tr>
		
                </table></td>
    <td width="40"></td>
    <td valign="top"><!--DWLayoutEmptyCell-->&nbsp;</td>
        <td width="107"></td>
  </tr>
  <tr>
    <td>&nbsp;</td>
    <td valign="top" class="titulo_principal_cap Estilo9">Seguridad simple para un sitio web</td>
    <td></td>
  </tr>
  <tr>
    <td>&nbsp;</td>
    <td valign="top" class="titulo_secundario">(por Marcelo Barreto y Esteban Cerutti) - </span> 11/Enero/2008 - <a href="20080111.htm"><strong>Permalink</strong></a> </td>
    <td></td>
  </tr>
  <tr>
    <td>&nbsp;</td>
    <td valign="top" class="parrafo_normal">    <strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</strong>A veces, nos puede suceder, que necesitemos restringir el acceso a un sitio web hecho solamente en HTML, como puede ser el caso de corriere, y al internar agregarle alg&uacute;n manejo de usuario y contrase&ntilde;as con PHP o Perl, podemos llegar a encontrarnos con un problema m&aacute;s que una soluci&oacute;n.<br>
          <br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Supongamos que deseamos restringir el acceso al corriere a trav&eacute;s de usuario y contrase&ntilde;a. Una soluci&oacute;n ser&iacute;a armar un peque&ntilde;o script en PHP o Perl que solicite los datos, los busque en un archivo de texto, y una vez autenticado el usuario, inicie una sesi&oacute;n;  la parte m&aacute;s tediosa consistir&iacute;a en pasar todas nuestras p&aacute;ginas HTML a PHP o Perl, agreg&aacute;ndole algunas l&oacute;neas al comienzo de cada una,  para que verifique la sesi&oacute;n del usuario. Y adem&aacute;s nos quedar&iacute;a la responsabilidad de mantener el archivo de usuarios y contrase&ntilde;as (altas, bajas, cambio de password, etc).<br>
  <br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Supongamos que para ahorrarnos un poco de trabajo al realizar el alta de todos los usuarios que se conectan desde el trabajo, queremos permitir el acceso libre a las p&aacute;ginas si la direcci&oacute;n IP de la m&aacute;quina pertenece a la red interna del laboratorio; pero manteniendo el acceso restringido desde Internet. Esto requiere modificar nuevamente cada p&aacute;gina para que verifique desde que IP es solicitada y si no pertenece a la red interna del trabajo, reci&eacute;n entonces verifiqu&eacute; si el usuario inici&oacute; sesi&oacute;n.<br>
  <br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Podemos aprovechar el hecho de que cada usuario ya posee un usuario (valga la redundancia) y contrase&ntilde;a para su cuenta de correo; y as&iacute; podemos evitarnos tener que mantener un archivo de texto. Esto requerir&aacute; que agreguemos cierta complejidad al script de PHP o Perl para que pueda conversar con un servidor de correo IMAP o POP3 y realizar al autenticaci&oacute;n correspondiente.<br>
  <br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Finalmente, pasamos de tener un sitio sencillo realizado puramente en HTML,  a algo medio complejo hecho en PHP o Perl. Existir&aacute; una soluci&oacute;n alternativa que sea m&aacute;s sencilla? La respuesta es S&iacute;, y nos la provee el servidor mismo de p&aacute;ginas web (Apache).<br>
  <br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Podemos agregarle autenticaci&oacute;n a un sitio web aprovechando que Apache (suponiendo que &eacute;ste sea el servidor web que estamos utilizando) te ofrece la mayor&iacute;a de las cosas que necesitamos: un sistema de control de acceso basado en IPs o dominios, y un sistema de autenticaci&oacute;n por usuario y contrase&ntilde;a, ahorr&aacute;ndonos de esta manera realizar un script en  PHP, Perl o algo similar.<br>
  <br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Todo esto se configura con directivas que le damos al Apache. Existen dos maneras de hacerlo: <br>
        1. Declarando estas directivas directamente en el archivo de configuraci&oacute;n de Apache (generalmente <strong>httpd.conf</strong>), la cual es la soluci&oacute;n recomendada, pero muchas veces no tenemos privilegios de administrador como para tocar el archivo de configuraci&oacute;n. <br>
  <br>
        2.En ese caso podemos crear un archivo <strong>.htaccess</strong> con las directivas y ponerlo dentro del directorio que se ver&aacute; afectado por las mismas, procedimiento poco recomendado pero que no requiere privilegios.
        <P class=contenidos>Por ejemplo, supongamos que los archivos del corriere.lifia.info.unlp.edu.ar est&aacute;n guardados en el directorio /var/www/lifia/corriere de un servidor GNU/Linux al cual tenemos acceso por FTP, y deseamos agregar la directiva: </P>
      <P class=contenidos>Quote:<br>
        AddType text/example.exm</P>
      <P class=contenidos>usando la 1ra. opci&oacute;n tendr&iacute;amos que modificar el archivo de configuraci&oacute;n y agregar la directiva en la secci&oacute;n Directory del dominio: </P>
      <P class=contenidos><strong>httpd.conf </strong></P>
      <P class=contenidos>Quote:<br>
  &lt;Directory /var/www/lifia/corriere&gt; <br>
        AddType text/example .exm<br>
  &lt;/Directory&gt;</P>
      <P class=contenidos>usando la 2da. opci&oacute;n tendr&iacute;amos que crear un archivo .htaccess en el directorio /var/www/lifia/corriere conteniendo: </P>
      <P class=contenidos>Quote:<br>
        AddType text/example.exm</P>
      <P class=contenidos><strong>Control de acceso </strong></P>
      <P class=contenidos>Para restringir/permitir el acceso seg&uacute;n la IP o un dominio se utilizan las siguientes directivas: </P>
      <P class=contenidos>Quote:<br>
        Order Allow,Deny <br>
        Allow from direcci&oacute;n <br>
        Deny from direcci&oacute;n</P>
      <P class=contenidos>donde direcci&oacute;n puede ser una direcci&oacute;n IP o un dominio. Siguiendo con nuestro ejemplo, para permitirle el acceso irrestricto a cualquier mquina perteneciente al dominio lifia.info.unlp.edu.ar, bastar&iacute;a con declarar:</P>
      <P class=contenidos>Quote:<br>
        Order Allow,Deny <br>
        Allow from lifia.info.unlp.edu.ar</P>
      <P class=contenidos>o si conocemos el rango de direcciones IP:</P>
      <P class=contenidos>Quote:<br>
        Order Allow,Deny <br>
        Allow from 192.168.1.0/24</P>
      <P class=contenidos><strong>Autenticaci&oacute;n B&aacute;sica </strong></P>
      <P class=contenidos>Apache permite proteger los recursos mediante un sistema b&aacute;sico de usuario y contrase&ntilde;a, para &eacute;sto se deben completar dos pasos: <br>
        1.Crear un archivo de contrase&ntilde;as <br>
        2.Configurar apache para que utilice este archivo </P>
      <P class=contenidos>Para crear el archivo de contrase&ntilde;as usamos el comando: </P>
      <P class=contenidos>Quote:<br>
        htpasswd -c /var/www/lifia/corriere/nombre_archivo nombre_usuario</P>
      <P class=contenidos>y nos va pedir que ingresemos dos veces la contrase&ntilde;a para ese usuario. Ejemplo: </P>
      <P class=contenidos>Quote:<br>
        # htpasswd -c /var/www/lifia/corriere/claves pepe <br>
        New password: mypassword <br>
        Re-type new password: mypassword <br>
        Adding password for user pepe</P>
      <P class=contenidos>a partir de aqu&iacute;, para agregar un nuevo usuario basta con tipear: </P>
      <P class=contenidos>Quote:<br>
        htpasswd /var/www/lifia/corriere/claves pirulo</P>
      <P class=contenidos>y nos va a preguntar por la contrase&ntilde;a de pepe. </P>
      <P class=contenidos>Finalmente indicamos a Apache que utilice autenticaci&oacute;n b&aacute;sica y el archivo con las contrase&ntilde;as mediante las siguientes directivas: </P>
      <P class=contenidos>Quote:<br>
        AuthType Basic <br>
        AuthName &quot;Di amigo, y entra.&quot; <br>
        AuthUserFile /var/www/lifia/corriere/claves <br>
        Require valid-user</P>
      <P class=contenidos>cada vez que un cliente solicite cualquier recurso dentro del directorio /var/www/lifia/corriere o sus subdirectorios, el navegador le solicitar&aacute; que ingrese un usuario y una contrase&ntilde;a. </P>
      <P class=contenidos><strong>Combinando ambas cosas </strong></P>
      <P class=contenidos>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Faltar&iacute;a combinar ambas cosas para que deje pasar sin contrase&ntilde;a a cualquier usuario del dominio lifia y solicitar contrase&ntilde;a a aquellos que no pertenezcan. Para eso utilizamos la directiva Satisfy, esta directiva toma uno de dos argumentos all o any. Por defecto se asume que el valor es all, esto significa que deben cumplirse todos los criterios especificados para que un cliente tenga acceso. En nuestro caso usaremos el argumento any para que aquellos clientes provenientes del dominio lifia puedan acceder a los recursos sin necesidad de contrase&ntilde;a. </P>
      <P class=contenidos>Sumando todas las declaraciones nos quedar&iacute;a lo siguiente: </P>
      <P class=contenidos>Quote:<br>
  &lt;Directory /var/www/lifia/corriere&gt; <br>
        Order Allow,Deny <br>
        Allow from lifia.info.unlp.edu.ar <br>
        AuthType Basic <br>
        AuthName &quot;Di amigo, y entra.&quot; <br>
        AuthUserFile /var/www/lifia/corriere/claves <br>
        Require valid-user <br>
        Satisfy any <br>
  &lt;/Directory&gt;</P>
      <P class=contenidos><strong>M&oacute;dulo de Autenticaci&oacute;n por IMAP </strong></P>
      <P class=contenidos>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Apache nos permite, mediante un sistema de m&oacute;dulos, realizar la autenticaci&oacute;n b&aacute;sica contra un servidor de IMAP, LDAP, MySQL, etc., en lugar del archivo de usuarios y contrase&ntilde;as. Continuando con nuestro ejemplo, veamos como indicarle a Apache que autentique contra un servidor IMAP.<br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Con las siguientes dos directivas le indicamos a Apache que realice la autenticaci&oacute;n b&aacute;sica mediante IMAP en lugar de un archivo.</P>
      <P class=contenidos>Quote:<br>
        Auth_IMAP_Enabled on <br>
        Auth_IMAP_Authoritative on </P>
      <P class=contenidos>y luego le indicamos el servidor IMAP y el puerto al que debe conectarse:</P>
      <P class=contenidos>Quote:<br>
        Auth_IMAP_Server sol.lifia.info.unlp.edu.ar<br>
        Auth_IMAP_Port 143 </P>
      <P class=contenidos>con &eacute;stas cuatro directivas ya tenemos a Apache realizando la autenticaci&oacute;n de los usuarios contra un servidor IMAP. En resumen, nos quedar&iacute;a:<br>
        Quote:<br>
  &lt;Directory /var/www/lifia/corriere&gt; <br>
        Order Allow,Deny <br>
        Allow from lifia.info.unlp.edu.ar<br>
        Auth_IMAP_Enabled on <br>
        Auth_IMAP_Authoritative on <br>
        AuthType Basic <br>
        AuthName &quot;Di amigo, y entra.&quot; <br>
        Auth_IMAP_Server sol.lifia.info.unlp.edu.ar <br>
        Auth_IMAP_Port 143 <br>
        Require valid-user <br>
        Satisfy any <br>
  &lt;/Directory&gt;</P>
      <P class=contenidos>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Para terminar, queremos mencionar que la autenticaci&oacute;n es cada ves m&aacute;s necesaria en los sitios web. Aqu&iacute; hemos visto una forma sencilla de agregar seguridad, sin necesidad de modificar nuestros sitios, aprovechando la capacidad de autenticaci&oacute;n de los servidores Web como Apache.</P>
    <td></td>
  </tr>
  <tr>
    <td>&nbsp;</td>
    <td width="386"></td>
    <td></td>
  </tr>
  <tr>
    <td colspan="2" valign="top"><div align="left">
            <p>&nbsp;</p>
            <p><a href="../feed.xml" target="_blank">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<img border=0 src="../imagenes/rss.png"></a></p>
          </div></td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td></td>
  </tr>
  <tr>
    <td colspan="4" valign="top" class="menu_pie"><a href="about_us.htm" target="_self"> sobre nosotros</a> <span class="secciones">| <a href="research.htm" target="_self">investigaci&oacute;n</a> |</span> <a href="publications.htm" target="_self">publicaciones</a> <span class="secciones">|</span> <a href="technology.htm" target="_self">transferencia de t.</a> <span class="secciones">|</span> <a href="capabilities.htm" target="_self">capacidades</a> </td>
  </tr>
  <tr>
    <td colspan="6" valign="bottom" nowrap><img src="../imagenes/barra_down.gif" width="830" height="43" border="0" usemap="#Map"></td>
  </tr>
</table>
<map name="Map">
  <area shape="rect" coords="609,-31,743,22" href="http://www.amplioespectro.com" target="_blank">
</map>
</body>
</html>

<!-- Localized -->