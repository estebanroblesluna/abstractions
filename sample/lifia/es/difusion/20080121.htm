<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Lifia</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link rel="shortcut icon" href="../../imagenes/lifiaicon.ico" >
<style type="text/css">
<!--
@import url("../estilos_lifia.css");
body {
	background-color: #bec2d1;
	margin-left: 0px;
	margin-top: 5px;
	margin-right: 0px;
	margin-bottom: 0px;
	background-image: url();
}
a:link {
	color: #255282;
	text-decoration: none;
}
a:visited {
	text-decoration: none;
	color: #255282;
}
a:hover {
	text-decoration: none;
	color: #FF9933;
}
a:active {
	text-decoration: none;
	color: #FF9933;
}
.Estilo4 {color: #666666}
.Estilo8 {color: #1EA173}
.Estilo9 {color: #333399}

.centro{FONT-SIZE: 13px; COLOR: #666666; font-weight:bold;FONT-FAMILY: "Trebuchet MS", Verdana;
text-align:center;}
.linkTexto {
		COLOR: #0033CC; 	text-decoration:underline;
		font-weight:bold;}
-->
</style>
</head>

<body>
<script type="text/javascript" src="wz_tooltip.js"></script>
<table width="830" border="0" align="center" cellpadding="0" cellspacing="0" background="../imagenes/line_830.gif">
  <!--DWLayoutTable-->
  <tr>
    <td width="30" rowspan="8" valign="top"><img src="../imagenes/spacer_izq2.gif" width="30" height="615"></td>
    <td colspan="4" valign="top"><table width="780" height="114" border="0" cellpadding="0" cellspacing="0">
        <!--DWLayoutTable-->
        <tr>
          <td width="780" height="170" valign="top"><img src="../imagenes/top_difusion.gif" width="780" height="172" border="0" usemap="#Map"></td>
        </tr>
    </table></td>
  <td width="20" rowspan="8" valign="top"><img src="../imagenes/spacer_der2.gif" width="20" height="485"></td>
  </tr>
  <tr>
    <td width="247" rowspan="5" valign="top"><table width="247" border="0" cellpadding="0" cellspacing="0">
        <!--DWLayoutTable-->
        <tr>
          <td height="19" colspan="3" valign="top"><img src="../imagenes/spacer_vert_19.gif" width="10" height="19"></td>
        </tr>
        <tr>
          <td width="41" rowspan="7" valign="top"><!--DWLayoutEmptyCell-->&nbsp;</td>
          <td height="19" colspan="2" valign="top" nowrap class="menu_izq"><a href="../index.htm" target="_self">Bienvenida</a></td>
        </tr>
        <tr>
          <td height="19" colspan="2" valign="top" nowrap class="menu_izq"><a href="../about_us.htm" target="_self">Sobre nosotros</a> </td>
        </tr>
        <tr>
          <td height="19" colspan="2" valign="top" nowrap class="menu_izq"><a href="../research.htm">Investigaci&oacute;n</a> </td>
        </tr>
        <tr>
          <td height="19" colspan="2" valign="top" nowrap><span class="menu_izq"> <a href="../publications.htm" target="_self">Publicaciones </a></span> &#13;</td>
        </tr>
        <tr>
          <td height="19" colspan="2" valign="top" nowrap class="menu_izq"><a href="../technology.htm" target="_self">Transferencia de tec. &amp; servicios </a>&#13;</td>
        </tr>
        <tr>
          <td height="19" colspan="2" valign="top" class="menu_izq"><span class="menu_izq Estilo8"> <a href="../capabilities.htm">Capacidades &#13;</a><strong> <a href="capabilities.htm">&#13;&#13;</a></strong></span> &#13;</td>
        </tr>
        <tr>
          <td height="19" colspan="2" valign="top"><a href="../difusion.htm" class="menu_izq"><strong>Difusi&oacute;n</strong></a></td>
        </tr>
        <tr>
          <td height="57">&nbsp;</td>
          <td width="84">&nbsp;</td>
          <td width="122">&nbsp;</td>
        </tr>
        <tr>
          <td height="84" colspan="3" valign="top"><img src="../imagenes/spacer_vert_84.gif" width="10" height="84"></td>
        </tr>
        <tr>
          <td height="16" colspan="2" valign="top"><div align="center" class="menu_negrita Estilo4"><a href="../sitemap.htm" target="_self">mapa del sitio</a> </div></td>
              <td rowspan="5" valign="top"><!--DWLayoutEmptyCell-->&nbsp;</td>
        </tr>
        <tr>
          <td height="16" colspan="2" valign="top"><div align="center" class="menu_negrita"><a href="../staff.htm" target="_self">staff</a></div></td>
        </tr>
        <tr>
          <td height="16" colspan="2" valign="top"><div align="center" class="menu_negrita Estilo4"><a href="../contact.htm" target="_self">contacto</a></div></td>
        </tr>
        <tr>
          <td height="16" colspan="2" valign="top"><div align="center" class="menu_negrita Estilo4"><a href="../../en/index.htm" target="_self">english version</a> </div></td>
        </tr>
        <tr>
          <td height="16"></td>
          <td></td>
        </tr>
		        <tr>
		          <td>&nbsp;</td>
                  <td>&nbsp;</td>
                  <td>&nbsp;</td>
        </tr>
		
                </table></td>
    <td width="40"></td>
    <td valign="top"><!--DWLayoutEmptyCell-->&nbsp;</td>
        <td width="107"></td>
  </tr>
  <tr>
    <td>&nbsp;</td>
    <td valign="top" class="titulo_principal_cap Estilo9">Migrador Genérico</td>
    <td></td>
  </tr>
  <tr>
    <td>&nbsp;</td>
    <td valign="top" class="titulo_secundario">(por Alfonso Quiroga) - </span> 21/Enero/2008 - <a href="20080121.htm"><strong>Permalink</strong></a> </td>
    <td></td>
  </tr>
  <tr>
    <td>&nbsp;</td>
    <td valign="top" class="parrafo_normal">    <p><strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</strong><span class="contenidos">En Chile se encuentran &quot;Tiendas Par&iacute;s&quot;, una tienda con varias sucursales que vende todo tipo de productos. La consultora inform&aacute;tica NECTIA trabaja para ellos, y en esta ocasi&oacute;n se necesitaba hacer una migraci&oacute;n de datos. La migraci&oacute;n consist&iacute;a en llevar datos desde planillas de c&aacute;lculo (archivos .XLS) hacia una cierta base de datos. Se podr&iacute;a haber hecho un migrador espec&iacute;fico para este caso, lo cual hubiera servido, pero hubiese sido muy poco reusable. Bajo el dise&ntilde;o, seguimiento y conducci&oacute;n de Tom&aacute;s Vera, hice un migrador gen&eacute;rico, que toma un source (en este caso, archivos .XLS), un parser, y finalmente un archivo de configuraci&oacute;n (.XML) donde se le describe al migrador como mapear cada entidad y atributos. El migrador finalmente levanta todos los datos a objetos, para que Hibernate (o alguna herramienta ORM similar) termine persistiendo estos objetos en una base de datos espec&iacute;fica. Resumiendo, el migrador se encarga de mapear entidades desde alg&uacute;n source a objetos java.<br>
        <br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                Entrando  en m&aacute;s detalle, como en este caso puntual necesit&aacute;bamos migrar archivos .XLS, se us&oacute; un parser basado en Jakarta POI (de Apache) que posee una interfaz simple para manipular archivos .XLS y .DOC (propietarios de Microsoft). En muchos casos,  las migraciones no se hacen mapeando los atributos tal como se encuentran, muchas veces tiene que sufrir alguna transformaci&oacute;n, por ejemplo, podemos encontrarnos con un string &quot;2002*06*17&quot; que representa una fecha, y est&aacute; claro que al migrar, en el objeto Java no queremos que quede ese string crudo, sino una instancia de java.util.Date que represente dicha fecha. Es por esto que surge la necesidad de &quot;transformadores&quot;. Este migrador ya trae algunos transformadores (como el de fecha), pero se sabe que en una migraci&oacute;n se pueden necesitar nuevos transformadores, para lo cual hay que extender una clase de migrator.core.transformer.Transformer, y escribir la l&oacute;gica necesaria.<br>
  <br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Viendo ahora al migrador como una herramienta a la cual se le pueden &quot;enchufar&quot; nuevos sources, parsers y transformadores, podemos concluir que esta herramienta nos puede servir para much&iacute;simos casos, teniendo que codificar solamente (en caso de no tenerlos) nuevos parsers, pero reusando la l&oacute;gica del migrador. <br>
  <br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Ahora bien, respecto a las asociaciones, hagamos de cuenta que tenemos dos archivos source: PERSONA.XLS y CASA.XLS, y sabemos que una persona puede poseer varias casas (CASA.XLS tiene una referencia a que persona pertenece) &iquest;c&oacute;mo tratamos estos casos con el migrador? Bien, el migrador posee un &iacute;ndice interno, y mientras va creando instancias, las va indexando. Asumiendo que las entidades tienen un atributo que las identifica un&iacute;vocamente, esto ser&iacute;a suficiente para hacer asociaciones. <br>
  <br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Supongamos que cada persona tiene un DNI y cada casa tiene un casaId (ambos atributos claves). Nosotros podemos decirle al migrador que cada vez que cree una instancia de model.Persona, deje indexada esa instancia por su DNI, y lo mismo para cada casa. Si en Java una Persona tiene una colecci&oacute;n de casas, cuando el migrador procese CASA.XLS y se encuentre con el DNI del due&ntilde;o, tiene que ir a esa persona y agregarla a la colecci&oacute;n (&iexcl;la persona ya tiene que existir en memoria!). En este punto nos dimos cuenta de que el orden importa, es decir, hay que generar primero instancias de model.Persona, y luego procesar model.Casa. El archivo de configuraci&oacute;n del migrador tendr&aacute; el siguiente orden:<br>
      1) Procesar PERSONA.XLS<br>
      2) Procesar CASA.XLS<br>
  <br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Teniendo ese tipo de precauciones, el migrador va a funcionar sin problemas. Es com&uacute;n cometer todo tipo de errores, por ejemplo mapear hacia clases que no existen, o mapear hacia atributos java que no existen, que s&oacute;lo en tiempo de ejecuci&oacute;n (v&iacute;a reflection) nos damos cuenta. Para esto el migrador usa Log4J informando claramente cuando nos encontramos con un error, y dando la mayor cantidad de informaci&oacute;n para que el usuario no tenga que andar &quot;adivinando&quot; lo que pas&oacute;.<br>
  <br>
  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Dado que la herramienta es gen&eacute;rica y se configura mediante un archivo .XML, soporta cualquier source (por ej. si se desea consumir datos de un webService, se escribe un nuevo Source que lo represente y listo). Soporta tambi&eacute;n nuevos transformadores, nuevos parsers, tipos de datos nuevos y asociaciones entre diferentes sources (usando memoria temporal indexada). Podemos concluir entonces que esta herramienta se puede usar para cualquier caso en el que sea necesario migrar datos desde alg&uacute;n source (origen) y levantarlo a un modelo de objetos previamente hecho. </span>    </p>
      <p class="centro"><img src="20080121/AlfonsoTomas.jpg" width="345" height="259"></p>
    <td></td>
  </tr>
  <tr>
    <td>&nbsp;</td>
    <td width="386"></td>
    <td></td>
  </tr>
  <tr>
    <td colspan="2" valign="top"><div align="left">
            <p>&nbsp;</p>
            <p><a href="../feed.xml" target="_blank">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<img border=0 src="../imagenes/rss.png"></a></p>
          </div></td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td></td>
  </tr>
  <tr>
    <td colspan="4" valign="top" class="menu_pie"><a href="about_us.htm" target="_self"> sobre nosotros</a> <span class="secciones">| <a href="research.htm" target="_self">investigaci&oacute;n</a> |</span> <a href="publications.htm" target="_self">publicaciones</a> <span class="secciones">|</span> <a href="technology.htm" target="_self">transferencia de t.</a> <span class="secciones">|</span> <a href="capabilities.htm" target="_self">capacidades</a> </td>
  </tr>
  <tr>
    <td colspan="6" valign="bottom" nowrap><img src="../imagenes/barra_down.gif" width="830" height="43" border="0" usemap="#Map"></td>
  </tr>
</table>
<map name="Map">
  <area shape="rect" coords="609,-31,743,22" href="http://www.amplioespectro.com" target="_blank">
</map>
</body>
</html>

<!-- Localized -->